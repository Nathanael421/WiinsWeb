<!-- Component Body -->
<div class="card d-block">
  <div class="cardbox bg-white">
    <!-- Heading Card -->
    <div class="cardbox-heading p-3 row mx-0">
      <div class="col-10 col-md-10 row mx-0">
        <div class="d-flex media col px-0">
          <div [routerLink]="[link]" class="avatar-owner">
            <img class="rounded-circle w-100 h-100" [src]="avatarPublication" alt="User">
          </div>
          <div class="avatar-owner" *ngFor="let p of taggedProfile" [routerLink]="'/profile/' + p._id">
            <img class="rounded-circle w-100 h-100" [src]="p.pictureprofile" alt="User">
          </div>
          <div class="description ms-3">
            <div class="row">
              <p [routerLink]="[link]" class="owner-publication mb-0">{{name}}</p>
              <p class="mb-0 ms-2" *ngIf="publication?.group"> âžœ {{publication.group.name}}</p>
              <p class="mb-0 ms-2"
                *ngIf="publication.type !== 'VideoPublication' && publication.type !== 'PicturePublication' && publication.type !== 'PostPublication'">
                ({{'CORE.Sponsored'|translate}})
              </p>
            </div>
            <small><span>{{getDateCreation(publication.createdAt)}}</span></small>
          </div>
        </div>
      </div>
      <div class="col-2 col-md-2 mt-1">
        <div ngbDropdown class="dropdown">
          <button ngbDropdownToggle id="dropdownBasic1" class="btn btn-flat btn-flat-icon" type="button">
            <em class="fa fa-ellipsis-h"></em>
          </button>
          <div ngbDropdownMenu aria-labelledby="dropdownBasic1" class="dropdown-menu dropdown-scale dropdown-menu-right"
            role="menu">
            <a class="dropdown-item" (click)="delete(publication._id)"
              *ngIf="ownerId === (profile$|async)?._id || mypageId === true || mygroup == true">{{'BTN-DROPDOWN.Delete'|translate}}</a>
            <a class="dropdown-item" (click)="report(publication)">{{'BTN-DROPDOWN.Report'|translate}}</a>
          </div>
        </div>
      </div>
    </div>
    <!-- Type of card -->
    <div [ngSwitch]="publication.type">
      <!-- Picture Mode -->
      <div *ngSwitchCase="'PicturePublication'" class="cardbox-item container-picture-publication">
        <img (click)="openModal()" class="img-fluid clickModal img-picture-publication w-100 img-responsive" [src]="publication.file"
          alt="Image">
        <div *ngIf="publication.text || publication.hastags?.length > 0" class="container-description w-100">
          <div class="display-hover">
            <div class="container py-4">
              <div class="row">
                <div class="mx-auto px-4 text-center">
                  <span>{{publication.text}}</span>
                </div>
              </div>
              <div class="row row-cols-auto container-oneHastag px-4 py-2 float-right">
                  <div class="oneHastag py-1 mx-1 my-1" *ngFor="let item of publication.hastags"
                  (click)="redirectionToHastag(item)">
                  <span class="col">#{{item}}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Video Mode -->
      <div *ngSwitchCase="'VideoPublication'" class="cardbox-item">
        <div *ngIf="!playVideo" class="container-btn-play row mx-0 w-100 h-100" (click)="openModal()">
          <img (click)="startVideo()" class="btn-play m-auto"
            src="https://eps-file-default.s3.eu-west-3.amazonaws.com/play-button.png">
        </div>
        <img *ngIf="!playVideo" class="img-fluid clickModal" [src]="publication.poster">
        <div *ngIf="playVideo == true" class="zone-modal-video w-100" (click)="openModal()"></div>
        <video #video *ngIf="playVideo == true" class="clickModal w-100 h-100" controls
          controlsList="nodownload noremoteplayback" autoplay>
          <source [src]="publication.file" type="video/mp4">
        </video>
      </div>
      <!-- Post Mode -->
      <div *ngSwitchCase="'PostPublication'" class="cardbox-item" [style.backgroundImage]="publication.background">
        <div (click)="openModal()" class="content-post-text clickModal">
          <div class="post-written d-flex">
            <div class="container">
              <div class="row">
                <span [ngClass]="[publication.hastags?.length > 0 ? 'pt-5 pb-3' : 'py-5']"
                  class="mx-auto my-auto px-2">{{publication.text}}</span>
              </div>
              <div class="row container-oneHastag px-4 py-2 float-right">
                <div class="oneHastag py-1 mx-1 my-1" (click)="redirectionToHastag(item)"
                  *ngFor="let item of publication.hastags">
                  <span class="col">#{{item}}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Info Stat -->
    <div class="cardbox-base">
      <div class="container">
        <div class="row my-2">
          <div class="my-1 col-7 text-left mx-0 ps-3">
            <a class="mx-1" (click)="btnLike()">
              <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="btn-like text-muted bi bi-suit-heart" *ngIf="!isLiked" viewBox="0 0 16 16">
                <path d="m8 6.236-.894-1.789c-.222-.443-.607-1.08-1.152-1.595C5.418 2.345 4.776 2 4 2 2.324 2 1 3.326 1 4.92c0 1.211.554 2.066 1.868 3.37.337.334.721.695 1.146 1.093C5.122 10.423 6.5 11.717 8 13.447c1.5-1.73 2.878-3.024 3.986-4.064.425-.398.81-.76 1.146-1.093C14.446 6.986 15 6.131 15 4.92 15 3.326 13.676 2 12 2c-.777 0-1.418.345-1.954.852-.545.515-.93 1.152-1.152 1.595L8 6.236zm.392 8.292a.513.513 0 0 1-.784 0c-1.601-1.902-3.05-3.262-4.243-4.381C1.3 8.208 0 6.989 0 4.92 0 2.755 1.79 1 4 1c1.6 0 2.719 1.05 3.404 2.008.26.365.458.716.596.992a7.55 7.55 0 0 1 .596-.992C9.281 2.049 10.4 1 12 1c2.21 0 4 1.755 4 3.92 0 2.069-1.3 3.288-3.365 5.227-1.193 1.12-2.642 2.48-4.243 4.38z"/>
              </svg>
              <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="btn-liked text-danger bi bi-suit-heart-fill" *ngIf="isLiked" viewBox="0 0 16 16">
                <path d="M4 1c2.21 0 4 1.755 4 3.92C8 2.755 9.79 1 12 1s4 1.755 4 3.92c0 3.263-3.234 4.414-7.608 9.608a.513.513 0 0 1-.784 0C3.234 9.334 0 8.183 0 4.92 0 2.755 1.79 1 4 1z"/>
              </svg>
            </a>
            <span class="my-auto" (click)="openLikedList()" [ngClass]="{'cursor-pointer': numberLike > 0}">
              {{numberLike}} {{'CORE.Like'|translate}}
            </span>
          </div>
          <div class="my-auto comment-share col-5 pe-3">
            <span class="mx-2">{{numberComment}}</span>
            <a (click)="openModal()" class="clickModal">
              <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="btn-comment text-muted 25bi bi-chat" viewBox="0 0 16 16">
                <path d="M2.678 11.894a1 1 0 0 1 .287.801 10.97 10.97 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8.06 8.06 0 0 0 8 14c3.996 0 7-2.807 7-6 0-3.192-3.004-6-7-6S1 4.808 1 8c0 1.468.617 2.83 1.678 3.894zm-.493 3.905a21.682 21.682 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a9.68 9.68 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105z"/>
              </svg>
            </a>
          </div>
        </div>
      </div>
    </div>
    <!-- Write a comment -->
    <div class="cardbox-comments p-2">
      <span class="comment-avatar">
        <a>
          <img class="rounded-circle" [src]="(profile$ | async)?.pictureprofile">
        </a>
      </span>
      <div class="new-comment">
        <div class="row mx-0 py-1">
          <div class="content-list-tag col-md-10 px-0"
            *ngIf="((spotSearch$|async) == 'feed-publication-standard' + publication._id ) && ((resultsProfile$ | async)?.length > 0)">
            <div class="container">
              <div class="row py-3 oneSuggest" *ngFor="let p of (resultsProfile$ | async)" (click)="addTag(p)">
                <div class="col-md-3 d-flex justify-content-center">
                  <img class="rounded-circle" [src]="p.pictureprofile">
                </div>
                <div class="col-md-9 my-auto px-0">
                  <span>
                    <p class="mb-0">{{p._meta.pseudo}}</p>
                  </span>
                </div>
              </div>
            </div>
          </div>
          <div class="col-10 col-md-10 my-auto content-input py-2" (keydown.enter)="sendComment(); false"
            (keydown)="writeComment($event)">
            <span #newComment class="postcomment" contenteditable="true" [innerHTML]="defaultComment"
              (focusin)='focusComment()'>
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>